language: python
sudo: false
cache: pip
env:
  global:
    - LD_PRELOAD=/lib/x86_64-linux-gnu/libSegFault.so
    - SEGFAULT_SIGNALS=all
      # CC_TEST_REPORTER_ID=
    - secure: A5pK06CxONo/hZSfl7Bk1/vYbQOEH5RqXf01FMav9n7qgEXsa4TeUOpsnpy1xSMfZtu7d7HuOUecdubKpEWvJIgA0vO98juguOZtN/crcpc6AA3XdEqVFM5NKYPBdtx2rcgWxbig3sFv1g1JIg3GRhWdYLmvSdxxF4vM1wDkwYztY+WaSXMigmMQz8/KOMhmXSdvjpLfEzk+NdSEIwEVrxlbFX8nZzTJxahN2W4kwBFlpzDeVDMIUWStUZHJKrswv75KfA2goRhGnT1/aLBa7dVl0M3ChTxrDHrgn7PZSuP+r1ORDd7hSx2730QhALHh4f8N+cOsNqyevgbpDlGEr+CgnJqcfi5jdkxaeQZ4f/aXCy2iQCIUeGElNahNoJ6bVqpPz9d9fCAGg9dYfKq/X5Wy+7TXr+9qlGBw5oYMavPELXR3qdY5rUxKsIoLmbRJq9/TRzKeeBP5ft8vlaX3MbYV6MJOxGc6TYn1XpS92LvDyqnm7M6ib2AgJhUfRttIu2cI5yebGRyNxF83Dl98qjPHU98UgHyJXJLPcAfgQA5GcvQGzUmCrhEQWtAGov6z7G3uvPmXm4bhkvtV8tP06QAcNFCwmHonjJMyrKNxkU1hPZjWwACPQ0gT6mLr+I67FReesjtx7IUugWB7Gi4I8RondV4IL41kfsk6FsSsq4k=
  matrix:
    - TOXENV=check
    - TOXENV=docs
matrix:
  include:
    - python: '2.7'
      env:
        - TOXENV=py27,codecov
    - python: '3.3'
      env:
        - TOXENV=py33,codecov
    - python: '3.4'
      env:
        - TOXENV=py34,codecov
    - python: '3.5'
      env:
        - TOXENV=py35,codecov
    - python: '3.6'
      env:
        - TOXENV=py36,codecov
    - python: 'pypy-5.4'
      env:
        - TOXENV=pypy,codecov

before_install:
  - python --version
  - uname -a
  - lsb_release -a

install:
  - pip install tox
  - pip install coverage
  - virtualenv --version
  - easy_install --version
  - pip --version
  - tox --version
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script:
  - tox -v
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT

after_failure:
  - more .tox/log/* | cat
  - more .tox/*/log/* | cat

notifications:
  email:
    on_success: never
    on_failure: always

deploy:
  # production pypi
  - provider: pypi
    distributions: sdist bdist_wheel
    user: bavo.van.achte
    password:
      secure: cKCBgEUOSUnlPbOxHCrXENlVgdMGnjNC+7nnutp/1xF8VEDF3aj9Br4u5LKrAYs0sm0AvnCyjhPvfKGPwyRDdfGBjoG06G+L+1hcfpgBlItmdSBqB8RxMm2B76si1ZlVI9gC58hlk/agFr2vik/mLXsH23rafB/2UwfB3ItTTx2J14xC5jlaqYR/srMJUi8YO5z6mGGLokfcz0KhYUHegOna38UcARM8rkAC2Je0xrPKZMlCoTI84dqwnFPW4zn3g/B5s3s18gmZu4fE4+J1g0PNMvxhbDP1TIBzPSWXLBv+YPSKrIT6+Q4R/kfDJFzLn3SmDDnNOpD/OC8ssqVJOcQL3HhKQ7EAcxX9W+/Rt7mIpdJdDXohiPrBl9EdRYbhB+KiPeo/dekAV6loUP/8cHuEgjcW/gE8t+HIqWsa5SO9yK7Sz8Ym+0ENdzS1df0iPOj2ebR3kb1iwINdFi7zIG6Utvlf7w1A2Qtx1xfI2+woPU+GOgQrpwdw64Wl1uo4l0kqTpFkytIG7BEVWC+zPPzqddi+3Ulf9AkWSjNDTqYafxZ9oqBJ5q7WPH8zyPQHotcHbnziTAnv7qRa+CTFLeME/KXNT8egToLK75G367lANTFIhMm8eSDS7wAxFWHacq8j68wNb38Yj1Rv1WMHQh14sxOkzQ4hVEV0xYY7Bj8=
    on:
      branch: master
      python: 3.6
      tags: true
